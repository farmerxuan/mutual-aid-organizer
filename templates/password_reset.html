{% extends 'layout.html' %}
{% block body %}
<div class="container mt-4">
  <h2>Password reset for {{ username }}</h2>
  <form id="resetForm">
    <div class="mb-3">
      <label class="form-label">New password</label>
      <input type="password" id="password" class="form-control">
    </div>
    <button type="submit" class="btn btn-primary">Set Password</button>
  </form>
</div>
<script>
document.getElementById('resetForm').addEventListener('submit', async function(e){
  e.preventDefault();
  const pw = document.getElementById('password').value;
  const res = await fetch(`/password-reset/{{ token }}`, {method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({password: pw})});
  if(res.ok){ alert('Password updated. You may now login.'); window.location='/'; } else { alert('Error'); }
});
</script>
{% endblock %}
